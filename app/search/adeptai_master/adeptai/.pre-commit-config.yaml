# Pre-commit hooks to prevent API key exposure
repos:
  - repo: local
    hooks:
      - id: check-api-keys
        name: Check for hardcoded API keys
        entry: python security_config.py
        language: system
        files: \.(py|js|ts|json|yaml|yml|md)$
        pass_filenames: false
        
      - id: check-env-files
        name: Check for .env files in commits
        entry: bash -c 'if git diff --cached --name-only | grep -E "\.env$|\.env\."; then echo "ERROR: .env files should not be committed!"; exit 1; fi'
        language: system
        
      - id: check-secrets
        name: Check for common secret patterns
        entry: bash -c 'if git diff --cached | grep -E "(sk-[a-zA-Z0-9]{20,}|sk-ant-[a-zA-Z0-9]{20,}|[a-zA-Z0-9]{32,})"; then echo "ERROR: Potential API key or secret detected!"; exit 1; fi'
        language: system
